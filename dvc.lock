schema: '2.0'
stages:
  normalize_weather_data:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2019-01-01
      2019-12-31
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: 10cebf0be330be5ba61c9ad936958650
      size: 10916
  normalize_citibike_data:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2019-01-01
      2019-12-31 100 10000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: 27031ccc65677d649ac69a0194c338e2
      size: 2696141
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: f344408426ebf34a790d4d51fb6d0061
      size: 1702594
  normalize_crash_data:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2019-01-01
      2019-12-31
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: 69fcc12ea38e758c632b9e8ab6e1f21b
      size: 591322
  join_crash_data_to_nodes:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: 69fcc12ea38e758c632b9e8ab6e1f21b
      size: 591322
    - path: target_map.graphml
      md5: 27031ccc65677d649ac69a0194c338e2
      size: 2696141
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: a4c9995592fce27e1baf5c24c64cedf3
      size: 88377
  join_all_data:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: a4c9995592fce27e1baf5c24c64cedf3
      size: 88377
    - path: trip_data_normalized.pkl.gz
      md5: f344408426ebf34a790d4d51fb6d0061
      size: 1702594
    - path: weather_data_normalized.pkl.gz
      md5: 10cebf0be330be5ba61c9ad936958650
      size: 10916
    outs:
    - path: unified_dataset.pkl.gz
      md5: 12c43e67600d01b0ce87d9c186414172
      size: 1357913
  create_map:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh_below_34th
    outs:
    - path: target_map.graphml
      md5: 27031ccc65677d649ac69a0194c338e2
      size: 2696141
  associate_ctas_to_nodes:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: 27031ccc65677d649ac69a0194c338e2
      size: 2696141
    - path: unified_dataset.pkl.gz
      md5: 12c43e67600d01b0ce87d9c186414172
      size: 1357913
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: da9edc12e1ae2290a462c9b1d413e571
      size: 8948
  compute_danger:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: 54ee140b974a83495a4aa4e5e6b219ef
      size: 8948
    - path: target_map.graphml
      md5: 27031ccc65677d649ac69a0194c338e2
      size: 2696141
    - path: unified_dataset.pkl.gz
      md5: 12c43e67600d01b0ce87d9c186414172
      size: 1357913
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: 5fdd2e436dfe56d19ece49070180d439
      size: 21428
    - path: target_map_consolidated.graphml
      md5: d0e771646b98acd7c0cbf288207778df
      size: 2396203
  generate_heatmaps:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: 5fdd2e436dfe56d19ece49070180d439
      size: 21428
    - path: target_map_consolidated.graphml
      md5: d0e771646b98acd7c0cbf288207778df
      size: 2396203
  normalize_weather_data@2020:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2020-01-01
      2020-12-31
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: dad271c85f8d28dd2f944e4512e44b9e
      size: 10423
  normalize_weather_data@2021:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2021-01-01
      2021-11-01
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: e308056fc894bb6ccbfe0f414e391520
      size: 9130
  create_map@2021:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh_below_34th
    outs:
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
  normalize_crash_data@2021:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2021-01-01
      2021-11-01
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: 8d3c1c697f24a9331158464f2a9eec06
      size: 412062
  join_crash_data_to_nodes@2021:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: 8d3c1c697f24a9331158464f2a9eec06
      size: 412062
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 75331b9b4c78690d70c1f496f031983d
      size: 59155
  normalize_citibike_data@2021:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2021-01-01
      2021-11-01 100 10000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: 99c4b246d9f59426798835a0d4780b7c
      size: 1611793
  join_all_data@2021:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 75331b9b4c78690d70c1f496f031983d
      size: 59155
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
    - path: trip_data_normalized.pkl.gz
      md5: 99c4b246d9f59426798835a0d4780b7c
      size: 1611793
    - path: weather_data_normalized.pkl.gz
      md5: e308056fc894bb6ccbfe0f414e391520
      size: 9130
    outs:
    - path: unified_dataset.parquet
      md5: f77502d56ca25bb481aaccc644c214d1
      size: 2373881
  associate_ctas_to_nodes@2021:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: f62be295cec949b473379f7e19050e12
      size: 8948
  create_map@2019:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh_below_34th
    outs:
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
  normalize_weather_data@2019:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2019-01-01
      2019-12-31
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: 82396bd412a3487d4639e0d3d9bcc75e
      size: 10916
  normalize_crash_data@2019:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2019-01-01
      2019-12-31
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: 273860906793003946e524528a9be903
      size: 591322
  join_crash_data_to_nodes@2019:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: 273860906793003946e524528a9be903
      size: 591322
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: bcc6a45a24584827eefbeaf0968689b9
      size: 88378
  normalize_citibike_data@2019:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2019-01-01
      2019-12-31 100 100000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: f81e0b0817bfbdceaad53f7d096ac082
      size: 16286329
  join_all_data@2019:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: bcc6a45a24584827eefbeaf0968689b9
      size: 88378
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
    - path: trip_data_normalized.pkl.gz
      md5: f81e0b0817bfbdceaad53f7d096ac082
      size: 16286329
    - path: weather_data_normalized.pkl.gz
      md5: 82396bd412a3487d4639e0d3d9bcc75e
      size: 10916
    outs:
    - path: unified_dataset.parquet
      md5: 877ae64aaff10665ba95426fc831b60e
      size: 19743322
  associate_ctas_to_nodes@2019:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: efad478955e73ad8d4fb648f7cd9345c
      size: 8948
  compute_danger@2019:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: efad478955e73ad8d4fb648f7cd9345c
      size: 8948
    - path: target_map.graphml
      md5: 9762351917f80b789719cbc2a47c1b26
      size: 2695878
    - path: unified_dataset.parquet
      md5: 877ae64aaff10665ba95426fc831b60e
      size: 19743322
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: 5f12580b1b351afe7522b948ec19f77e
      size: 24172
    - path: target_map_consolidated.graphml
      md5: 4117c8c5ba0951a1710b3bb43eab9e4a
      size: 2410335
  create_map@2020:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh_below_34th
    outs:
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
  normalize_crash_data@2020:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2020-01-01
      2020-12-31
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: 19c68cff989e1fb682bd0c27f6ca394e
      size: 476706
  join_crash_data_to_nodes@2020:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: 19c68cff989e1fb682bd0c27f6ca394e
      size: 476706
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: d4e85584e0a26361ca206dfeff783d49
      size: 57894
  normalize_citibike_data@2020:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2020-01-01
      2020-12-31 100 100000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: 9c72235ed9e7f6370c521e344c9a5410
      size: 16416628
  join_all_data@2020:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: d4e85584e0a26361ca206dfeff783d49
      size: 57894
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
    - path: trip_data_normalized.pkl.gz
      md5: 9c72235ed9e7f6370c521e344c9a5410
      size: 16416628
    - path: weather_data_normalized.pkl.gz
      md5: dad271c85f8d28dd2f944e4512e44b9e
      size: 10423
    outs:
    - path: unified_dataset.parquet
      md5: 3cfe6d31737217be4042f51f7b8d1c8e
      size: 20163714
  associate_ctas_to_nodes@2020:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: f9dd2db44c26f1952a31b7667d790d62
      size: 8948
  compute_danger@2020:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: f9dd2db44c26f1952a31b7667d790d62
      size: 8948
    - path: target_map.graphml
      md5: 4e7182ebc0a30045e7fac7dd73ab3a95
      size: 2695878
    - path: unified_dataset.parquet
      md5: 3cfe6d31737217be4042f51f7b8d1c8e
      size: 20163714
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: cc8aab1c600c919ca62e05758909ee30
      size: 22051
    - path: target_map_consolidated.graphml
      md5: 7bb62d85194115534ada7e6128d28c68
      size: 2410335
  generate_heatmaps@2019:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: 5f12580b1b351afe7522b948ec19f77e
      size: 24172
    - path: target_map_consolidated.graphml
      md5: 4117c8c5ba0951a1710b3bb43eab9e4a
      size: 2410335
  generate_heatmaps@2020:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: cc8aab1c600c919ca62e05758909ee30
      size: 22051
    - path: target_map_consolidated.graphml
      md5: 7bb62d85194115534ada7e6128d28c68
      size: 2410335
  compute_danger@2021:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: f62be295cec949b473379f7e19050e12
      size: 8948
    - path: target_map.graphml
      md5: cdd5e1c1aad89aece16a33f9670c5aed
      size: 2695878
    - path: unified_dataset.parquet
      md5: f77502d56ca25bb481aaccc644c214d1
      size: 2373881
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: caafcb12706eed17ba2f4a55ae285be5
      size: 20116
    - path: target_map_consolidated.graphml
      md5: 2d00d833b5bed41bb417d2f17c543671
      size: 2410335
  generate_heatmaps@2021:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: caafcb12706eed17ba2f4a55ae285be5
      size: 20116
    - path: target_map_consolidated.graphml
      md5: 2d00d833b5bed41bb417d2f17c543671
      size: 2410335
  normalize_weather_data@2019_thru_2021:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2019-01-01
      2021-11-01
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: 8ceeb65cf041812900b8a1cda2d4b470
      size: 26398
  create_map@2019_thru_2021:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh_below_34th
    outs:
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
  normalize_citibike_data@2019_thru_2021:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2019-01-01
      2021-11-01 100 1000000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: 386dab4e417f19897c04887b40df20de
      size: 155878202
  normalize_crash_data@2019_thru_2021:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2019-01-01
      2021-11-01
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: bb08a4c4fbdc11f18e494e50e90afdc1
      size: 1434809
  join_crash_data_to_nodes@2019_thru_2021:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: bb08a4c4fbdc11f18e494e50e90afdc1
      size: 1434809
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 2242a4a982ee39920a14aaa671b7a776
      size: 174515
  join_all_data@2019_thru_2021:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 2242a4a982ee39920a14aaa671b7a776
      size: 174515
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
    - path: trip_data_normalized.pkl.gz
      md5: 386dab4e417f19897c04887b40df20de
      size: 155878202
    - path: weather_data_normalized.pkl.gz
      md5: 8ceeb65cf041812900b8a1cda2d4b470
      size: 26398
    outs:
    - path: unified_dataset.parquet
      md5: 7f084a095fee59bbba0ed14e27f1ad8b
      size: 203083300
  associate_ctas_to_nodes@2019_thru_2021:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: 8b2d50753b7c6b4ff41bab09d3cef99a
      size: 8948
  compute_danger@2019_thru_2021:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: 8b2d50753b7c6b4ff41bab09d3cef99a
      size: 8948
    - path: target_map.graphml
      md5: a05cabc9846eae351f436e8fc42c13e8
      size: 2695878
    - path: unified_dataset.parquet
      md5: 7f084a095fee59bbba0ed14e27f1ad8b
      size: 203083300
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: 1f0a927211d41d93bac93e6f813f7a0e
      size: 28058
    - path: target_map_consolidated.graphml
      md5: eed0d41e9e739d5d4b49f99175678a0f
      size: 2410335
  generate_heatmaps@2019_thru_2021:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: 1f0a927211d41d93bac93e6f813f7a0e
      size: 28058
    - path: target_map_consolidated.graphml
      md5: eed0d41e9e739d5d4b49f99175678a0f
      size: 2410335
  normalize_weather_data@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/01_normalizing_weather_data.py 2019-01-01
      2021-11-01
    deps:
    - path: ../raw_data/weather/
      md5: f67235592662850f4b0856767095f685.dir
      size: 24203989
      nfiles: 4
    outs:
    - path: weather_data_normalized.pkl.gz
      md5: d1ebd94fbf2db8fde771db6d6d8913bc
      size: 26398
  create_map@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/00_create_map.py mnh
    outs:
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
  normalize_crash_data@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/02_normalizing_crash_data.py 2019-01-01
      2021-11-01
    deps:
    - path: ../raw_data/Motor_Vehicle_Collisions_-_Crashes.csv
      md5: 84bd8d0baf1943f1f3bfe319f420a176
      size: 395108006
    outs:
    - path: crash_data_normalized.pkl.gz
      md5: a34a1a7381d59bbf80567cb8120a63eb
      size: 1434809
  join_crash_data_to_nodes@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/03_joining_crash_data_to_nodes.py 100
    deps:
    - path: crash_data_normalized.pkl.gz
      md5: a34a1a7381d59bbf80567cb8120a63eb
      size: 1434809
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
    outs:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 6345cc092c367d378fc0d8b90e217ef9
      size: 468874
  normalize_citibike_data@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/04_normalizing_citibike_data.py 2019-01-01
      2021-11-01 100 1000000
    deps:
    - path: ../raw_data/citibike/
      md5: b6ae53a779ce6556f3a4587ebcab0f06.dir
      size: 2464917000
      nfiles: 33
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
    outs:
    - path: trip_data_normalized.pkl.gz
      md5: e375d486c6da5c2490b8f39d18c51d4b
      size: 253761206
  join_all_data@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/05_joining_all_data.py
    deps:
    - path: crash_data_normalized_with_node_graph.pkl.gz
      md5: 6345cc092c367d378fc0d8b90e217ef9
      size: 468874
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
    - path: trip_data_normalized.pkl.gz
      md5: e375d486c6da5c2490b8f39d18c51d4b
      size: 253761206
    - path: weather_data_normalized.pkl.gz
      md5: d1ebd94fbf2db8fde771db6d6d8913bc
      size: 26398
    outs:
    - path: unified_dataset.parquet
      md5: 60f2b3f385ea1723be0fa60d2fa697e9
      size: 321591083
  associate_ctas_to_nodes@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/06_associate_ctas_to_nodes.py
    deps:
    - path: ../raw_data/2010_Census_Tracts/geo_export_85c202c5-6ec9-493e-b0ec-a13efa26758d.shp
      md5: 0f6d2a4aaedc2e12f3db25f99d3f759e
      size: 2802360
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
    outs:
    - path: node_id_census_tract_key.pkl.gz
      md5: 3c3214d6cd2b33dabefac25bbd58b4c8
      size: 24225
  compute_danger@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/07_compute_danger.py
    deps:
    - path: node_id_census_tract_key.pkl.gz
      md5: 3c3214d6cd2b33dabefac25bbd58b4c8
      size: 24225
    - path: target_map.graphml
      md5: 0f25511d74f80421e86f8734c98ee281
      size: 7433810
    - path: unified_dataset.parquet
      md5: 60f2b3f385ea1723be0fa60d2fa697e9
      size: 321591083
    outs:
    - path: danger_by_node_id.pkl.gz
      md5: df01b9ac26c6db23a40b9c42f9774f3e
      size: 71783
    - path: target_map_consolidated.graphml
      md5: c0e76cad4767ea3eaaed5a7477e7aea8
      size: 6839942
  generate_heatmaps@2019_thru_2021_all_mnh:
    cmd: python ../../spoke/data_processing/08_generate_heatmaps.py
    deps:
    - path: danger_by_node_id.pkl.gz
      md5: df01b9ac26c6db23a40b9c42f9774f3e
      size: 71783
    - path: target_map_consolidated.graphml
      md5: c0e76cad4767ea3eaaed5a7477e7aea8
      size: 6839942
